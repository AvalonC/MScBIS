import{c,o as u,a as o,e as r,g as p,v as d,h,F as f,i as y,n as g,j as C,t as _}from"./app-D-TTs3Bk.js";import{_ as v}from"./plugin-vue_export-helper-DlAUqK2U.js";const w={name:"EnterpriseApplication",data(){return{qualifiedCompanies:[],companyName:"",selectedCompany:"",searchResults:[],showError:!1,showResults:!1,step:1,resultClass:"",resultMessage:"",dataLoaded:!1,loadFailed:!1}},computed:{pluginOptions(){return{dataPath:this.$withBase("/test.csv")}}},mounted(){console.log("组件挂载，开始加载企业数据"),console.log("插件配置:",this.pluginOptions),this.loadCompanyData()},methods:{async loadCompanyData(){try{const e=this.pluginOptions.dataPath;console.log("尝试加载文件:",e);const s=await fetch(e);console.log("HTTP状态码:",s.status);const l=s.headers.get("content-type")||"";if(console.log("内容类型:",l),!s.ok)throw new Error(`HTTP错误: ${s.status} ${s.statusText}`);const n=await s.text();if(console.log("原始数据长度:",n.length),this.isValidCSVData(n))this.processCSVData(n),console.log("✅ 有效的CSV文件加载成功"),this.dataLoaded=!0;else throw new Error("文件内容不是有效的CSV格式")}catch(e){console.log("❌ 加载失败:",e.message),this.loadFailed=!0}},isValidCSVData(e){if(!e||typeof e!="string")return!1;const s=e.trim();if(s.length===0||s.startsWith("<!DOCTYPE")||s.startsWith("<html")||s.includes("<body>")||s.includes("404")||s.includes("Not Found"))return!1;const l=s.split(`
`).filter(n=>n.trim().length>0);return l.length<2?!1:!!l[0].includes(",")},processCSVData(e){const s=e.split(`
`).filter(n=>n.trim()!==""),l=s[0].split(",").map(n=>n.trim());this.qualifiedCompanies=s.slice(1).map(n=>{const t=n.split(","),a={};return l.forEach((i,m)=>{a[i]=t[m]?.trim()}),a}),console.log("处理后的公司数据:",this.qualifiedCompanies)},searchCompanies(){const e=this.companyName.trim();this.showResults=!1,e!==""&&(this.searchResults=this.qualifiedCompanies.filter(s=>(s.company_name||"").toLowerCase().includes(e.toLowerCase())),this.showResults=this.searchResults.length>0)},selectCompany(e){this.selectedCompany=e,this.companyName=e.company_name},submitApplication(){if(this.companyName.trim()===""){this.showError=!0;return}this.showError=!1;const e=this.qualifiedCompanies.find(s=>(s.company_name||"").toLowerCase()===this.companyName.toLowerCase());if(e){this.resultClass="success";const s=[];e.fortune_global_2000==="true"&&s.push("全球2000强"),e.fortune_china_500==="true"&&s.push("中国500强"),e.global_tech_100==="true"&&s.push("全球IT100强"),e.china_tech_100==="true"&&s.push("中国IT100强"),e.hk_top_100==="true"&&s.push("香港100强"),e.hk_it_top_100==="true"&&s.push("香港IT100强"),e.is_unicorn==="true"&&s.push("独角兽"),s.length>0?this.resultMessage=`恭喜！"${e.company_name}"符合以下企业条件：<br> ${s.join("<br>")}`:this.resultMessage=`"${e.company_name}"在我们的数据库中，但未符合任何特定条件。`}else this.resultClass="failure",this.resultMessage=`抱歉！"${this.companyName}"不在我们的企业数据库中。`;this.step=2},resetForm(){this.companyName="",this.selectedCompany="",this.showError=!1,this.showResults=!1,this.step=1}}},N={class:"enterprise-application"},k={class:"container"},b={key:0,class:"loading"},T={key:1,class:"error-message"},E={key:2,class:"step-no-border"},F={class:"form-group"},L={class:"error"},V={id:"searchResultsContainer"},x={class:"search-results"},R=["onClick"],D={class:"form-group",style:{"margin-top":"16px"}},M={key:3,class:"step"},S=["innerHTML"],q={style:{"margin-top":"20px","text-align":"center"}};function P(e,s,l,n,t,a){return u(),c("div",N,[o("div",k,[s[8]||(s[8]=o("h1",null,"企业资格检测",-1)),r(" 加载中状态 "),!t.dataLoaded&&!t.loadFailed?(u(),c("div",b,s[5]||(s[5]=[o("p",null,"正在加载企业数据...",-1)]))):r("v-if",!0),r(" 加载失败状态 "),t.loadFailed?(u(),c("div",T,s[6]||(s[6]=[o("h2",null,"数据加载失败",-1),o("p",null,"无法加载企业数据，请稍后再试。",-1)]))):r("v-if",!0),r(" 第一步：填写公司名称 (只在数据成功加载时显示) "),t.dataLoaded&&t.step===1?(u(),c("div",E,[o("div",F,[s[7]||(s[7]=o("label",{for:"companyName"},"请输入公司官方全称：",-1)),p(o("input",{type:"text",id:"companyName","onUpdate:modelValue":s[0]||(s[0]=i=>t.companyName=i),placeholder:"例如：阿里巴巴集团",onInput:s[1]||(s[1]=(...i)=>a.searchCompanies&&a.searchCompanies(...i))},null,544),[[d,t.companyName]]),p(o("div",L,"公司名称不能为空",512),[[h,t.showError]])]),r(" 搜索结果区域 "),p(o("div",V,[o("div",x,[(u(!0),c(f,null,y(t.searchResults,(i,m)=>(u(),c("div",{key:m,class:"search-result-item",onClick:A=>a.selectCompany(i),style:C({background:t.selectedCompany===i?"rgba(227, 242, 253, 0.5)":""})},_(i.company_name),13,R))),128))])],512),[[h,t.showResults]]),o("div",D,[o("button",{onClick:s[2]||(s[2]=(...i)=>a.submitApplication&&a.submitApplication(...i))},"提交"),o("button",{class:"secondary",onClick:s[3]||(s[3]=(...i)=>a.resetForm&&a.resetForm(...i))},"重置")])])):r("v-if",!0),r(" 第二步：显示结果 "),t.dataLoaded&&t.step===2?(u(),c("div",M,[o("div",{class:g(["result-message",t.resultClass])},[t.resultMessage?(u(),c("div",{key:0,innerHTML:t.resultMessage},null,8,S)):r("v-if",!0)],2),o("div",q,[o("button",{onClick:s[4]||(s[4]=(...i)=>a.resetForm&&a.resetForm(...i))},"重新开始")])])):r("v-if",!0)])])}const H=v(w,[["render",P],["__scopeId","data-v-5cbfaec5"]]);export{H as default};
